#ifndef LIBPEX_H
#define LIBPEX_H

#ifdef __cplusplus
extern "C" {
#endif

#include <lib/libpe/pe.h>

typedef enum {
	PEX_E_OK = 0,

    PEX_E_NULL_PTR,
	PEX_E_MALLOC_FAIL,
	PEX_E_OPEN_FILE_FAILED,
	
} pex_err_e;

/* parse pe file */
typedef struct {
    pe_ctx_t pe_ctx;
} parse_pe_ctx_t;

parse_pe_ctx_t *parse_pe_load_file(char *path);
int pex_parse_pe(parse_pe_ctx_t *ctx);
void parse_pe_free(parse_pe_ctx_t *ctx);

#ifdef __cplusplus
} // extern "C"
#endif

#endif


