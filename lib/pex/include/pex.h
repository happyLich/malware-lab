#ifndef LIBPEX_H
#define LIBPEX_H

#ifdef __cplusplus
extern "C" {
#endif

#include <lib/libpe/pe.h>
#include <lib/libpe/error.h>

typedef enum {
    PEX_E_OK = 0,

    PEX_E_NULL_PTR,
    PEX_E_MALLOC_FAIL,
    PEX_E_OPEN_FILE_FAILED,

} pex_err_e;

double calculate_entropy_file(pe_ctx_t *ctx);
int8_t cpl_analysis(pe_ctx_t *ctx);
bool fpu_trick(pe_ctx_t *ctx);
bool normal_imagebase(pe_ctx_t *ctx);
IMAGE_SECTION_HEADER *pe_check_fake_entrypoint(pe_ctx_t *ctx);
bool normal_dos_stub(pe_ctx_t *ctx, uint32_t *stub_offset);
int pe_get_tls_callbacks(pe_ctx_t *ctx);
void get_strange_sections_num(pe_ctx_t *ctx, uint16_t *num_sections,
                int *num_zero_len, int *num_sus_name, int *num_self_mdf);

#ifdef __cplusplus
} // extern "C"
#endif

#endif

