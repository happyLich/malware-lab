#ifndef __PECKER_MCLA_H__
#define __PECKER_MCLA_H__
#include "pecker_mcla_svm.h"
#include "pecker_mcla_util.h"

#define BIN_IMAGE      0x00000001
#define ASM_3GRAM      0x00000002
#define ASM_4GRAM      0x00000004
#define API_3GRAM      0x00000008
#define API_4GRAM      0x00000010

#define MACHINE_LEARN_OPEN   1
#define MACHINE_LEARN_CLOSE   0

typedef struct
{
    svm_model_s *svm_m;
    
    double report;
    
    uint32_t model_type;
    uint32_t input_num;
    uint32_t img_width;
    int img_dist;
    uint8_t img_angel;
    
} mcla_t;

mcla_t *pecker_mcla_init();
int pecker_mcla_free(mcla_t *mcla);
int pecker_mcla_load_model(mcla_t *mcla, char *src, uint32_t input_num, uint32_t model_type);
int pecker_mcla_analysis_pe_file(mcla_t *mcla, char *src, int *report, int cmd);

int pecker_mcla_creat_img_train_data(char *src, char *dst);
int pecker_mcla_bin2img(char *src, char *dst, uint32_t height, uint32_t width);
int pecker_mcla_creat_pe_train_data(char *src, char *dst);
int pecker_mcla_creat_all_train_data(char *src, char *img_dst, char *pe_dst);

#endif

