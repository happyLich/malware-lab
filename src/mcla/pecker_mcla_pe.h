#ifndef __PECKER_MCLA_PE_H__
#define __PECKER_MCLA_PE_H__
#include <base/pecker.h>
#include <pex.h>

#define  PE_FEAT_VAL_NUM   16

typedef struct
{
    double is_dll;
    double cpl;
    double entropy;
    double fpu_trick;
    double normal_imagebase;
    double fake_entry;

    double dos_stub;
    double tls_dir;
    double num_sec;
    double zero_len;
    double sus_name;
    double self_mdf;
    
    double size_init;
    double dll_cha;
    double im_ver;
    double check_sum;
} pe_val_t;

//creat PE structure feature train data
#define PE_NODE_REALLOC_SIZE  1024

typedef struct
{
    char *path;
    int lable;
} pe_node_t;

typedef struct
{
    pe_node_t *pe_list;
    uint32_t pe_num;
    uint32_t pe_max;
} pe_train_data_para_t;

int init_pe_train_data_para(pe_train_data_para_t *para);
int add_pe_train_data(pe_train_data_para_t *para, char *src, int lable);
int creat_pe_train_data(pe_train_data_para_t *para, char *dst);
int free_pe_train_data_para(pe_train_data_para_t *para);

pe_ctx_t *analysis_pe(char *src, int *report, pe_val_t *pe_val, char *msg, int cmd);

#endif

